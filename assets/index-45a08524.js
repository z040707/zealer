import{a2 as re,r as u,m as U,o as c,c as y,w as z,Z as oe,a0 as K}from"./index-ce7fb889.js";import{u as se}from"./ZComment-d3d2a23d.js";import{f as ie,b as ae}from"./styled-components.browser.esm-b4eee38b.js";import{c as T}from"./input-52f9904a.js";import{a as ce}from"./index-f9dd01d7.js";function ue(s){var r=re(u.useState(s),2),t=r[0],i=r[1],g=u.useRef(t);g.current=t;var l=u.useCallback(function(){return g.current},[]);return[t,i,l]}const k="adm-page-indicator",le={color:"primary",direction:"horizontal"},de=u.memo(s=>{const r=U(le,s),t=[];for(let i=0;i<r.total;i++)t.push(c.createElement("div",{key:i,className:y(`${k}-dot`,{[`${k}-dot-active`]:r.current===i})}));return z(r,c.createElement("div",{className:y(k,`${k}-${r.direction}`,`${k}-color-${r.color}`)},t))});const F=s=>z(s,c.createElement("div",{className:"adm-swiper-item",onClick:s.onClick},s.children));function fe(s){const[r,t]=u.useState(s),i=u.useRef(r);return u.useEffect(()=>{i.current=r},[r]),[r,t,i]}function me(s,r){const t=Object.keys(s),i=Object.keys(r),g=new Set([...t,...i]),l={};return g.forEach(m=>{const x=s[m],v=r[m];typeof x=="function"&&typeof v=="function"?l[m]=function(...a){x(...a),v(...a)}:l[m]=x||v}),l}const f="adm-swiper",pe={mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp"},ge={defaultIndex:0,allowTouchMove:!0,autoplay:!1,autoplayInterval:3e3,loop:!1,direction:"horizontal",slideSize:100,trackOffset:0,stuckAtBoundary:!0,rubberband:!0,stopPropagation:[]};let E;const ve=u.forwardRef(ie((s,r)=>{const t=U(ge,s),[i]=u.useState({}),g=u.useRef(null),l=t.direction==="vertical",m=t.slideSize/100,x=t.trackOffset/100,{validChildren:v,count:a}=u.useMemo(()=>{let p=0;return{validChildren:c.Children.map(t.children,w=>!c.isValidElement(w)||w.type!==F?null:(p++,w)),count:p}},[t.children]);return a===0||!v?null:()=>{let p=t.loop;m*(a-1)<1&&(p=!1);const C=u.useRef(null);function w(){const e=C.current;return e?(l?e.offsetHeight:e.offsetWidth)*t.slideSize/100:0}const[$,G,L]=ue(t.defaultIndex),[_,j,R]=fe(!1);function S(e){let n=0,o=a-1;return t.stuckAtBoundary&&(n+=x/m,o-=(1-m-x)/m),T(e,n,o)}const[{position:P},M]=oe(()=>({position:S($)*100,config:{tension:200,friction:30},onRest:()=>{if(R.current||!p)return;const e=P.get(),n=100*a,o=O(e,n);o!==e&&M.start({position:o,immediate:!0})}}),[a]),N=u.useRef(null);function X(){var e;(e=N.current)===null||e===void 0||e.call(N),R.current=!1}const Z=se(e=>{if(N.current=e.cancel,!e.intentional||(e.first&&!E&&(E=i),E!==i))return;E=e.last?void 0:i;const n=w();if(!n)return;const o=l?1:0,d=e.offset[o],h=e.direction[o],I=e.velocity[o];if(j(!0),!e.last)M.start({position:d*100/n,immediate:!0});else{const H=Math.floor(d/n),te=H+1,ne=Math.round((d+I*2e3*h)/n);b(T(ne,H,te)),window.setTimeout(()=>{j(!1)})}},{transform:([e,n])=>[-e,-n],from:()=>{const e=w();return[P.get()/100*e,P.get()/100*e]},triggerAllEvents:!0,bounds:()=>{if(p)return{};const e=w(),n=S(0)*e,o=S(a-1)*e;return l?{top:n,bottom:o}:{left:n,right:o}},rubberband:t.rubberband,axis:l?"y":"x",preventScroll:!l,pointer:{touch:!0}});function b(e,n=!1){var o;const d=Math.round(e),h=p?O(d,a):T(d,0,a-1);h!==L()&&((o=t.onIndexChange)===null||o===void 0||o.call(t,h)),G(h),M.start({position:(p?d:S(d))*100,immediate:n})}function B(){b(Math.round(P.get()/100)+1)}function q(){b(Math.round(P.get()/100)-1)}u.useImperativeHandle(r,()=>({swipeTo:b,swipeNext:B,swipePrev:q})),ae(()=>{const e=v.length-1;$>e&&b(e,!0)});const{autoplay:D,autoplayInterval:V}=t,W=()=>{g.current=window.setTimeout(()=>{B(),W()},V)};u.useEffect(()=>{if(!(!D||_))return W(),()=>{g.current&&window.clearTimeout(g.current)}},[D,V,_,a]);function J(){return p?c.createElement("div",{className:`${f}-track-inner`},c.Children.map(v,(e,n)=>c.createElement(K.div,{className:y(`${f}-slide`,{[`${f}-slide-active`]:$===n}),style:{[l?"y":"x"]:P.to(o=>{let d=-o+n*100;const h=a*100,I=h/2;return d=O(d+I,h)-I,`${d}%`}),[l?"top":"left"]:`-${n*100}%`}},e))):c.createElement(K.div,{className:`${f}-track-inner`,style:{[l?"y":"x"]:P.to(e=>`${-e}%`)}},c.Children.map(v,(e,n)=>c.createElement("div",{className:y(`${f}-slide`,{[`${f}-slide-active`]:$===n})},e)))}const Q={"--slide-size":`${t.slideSize}%`,"--track-offset":`${t.trackOffset}%`},Y=Object.assign({},t.allowTouchMove?Z():{}),A={};for(const e of t.stopPropagation){const n=pe[e];A[n]=function(o){o.stopPropagation()}}const ee=me(Y,A);return z(t,c.createElement("div",{className:y(f,`${f}-${t.direction}`),style:Q},c.createElement("div",Object.assign({ref:C,className:y(`${f}-track`,{[`${f}-track-allow-touch-move`]:t.allowTouchMove}),onClickCapture:e=>{R.current&&e.stopPropagation(),X()}},ee),J()),t.indicator===void 0?c.createElement("div",{className:`${f}-indicator`},c.createElement(de,Object.assign({},t.indicatorProps,{total:a,current:$,direction:t.direction}))):t.indicator(a,$)))}}));function O(s,r){const t=s%r;return t<0?t+r:t}const ye=ce(ve,{Item:F});export{ye as S};
